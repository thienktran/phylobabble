<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>[MrBayes] Weirid results in Tracer. Can someone help?</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="phylobabble" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 04/01/2022.</div>
    <h1 class="topic-title">[MrBayes] Weirid results in Tracer. Can someone help?</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/386_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tsmoreira</div>
          <div class="post_content">
<p>Hello PhyloPeople. I have a MrBayes issue here.</p>
<p>I`m trying to run a combined analysis (morphological + DNA) from my dataset, But I ran into some weird results and I do not know what to make of it…</p>
<p>I made four different datasets (with different number of taxa) trying to investigate effects of adding morphological data on the final topology. I have on the matrices in question, 4521 characters, 256 of those morphological. All datasets were analyze under the exact same parameters (Same data partitioning models and parameters) where the only variation was the taxa coverage:</p>
<ul>
<li>M1 has 307 taxa where  12 have only morphological data, 202 taxa have only molecular data and 93 have both</li>
<li>M2 have 93 taxa where all of them have both morphological and molecular data</li>
<li>M3 have 105 taxa where all of them have morphological data but only 93 have molecular data</li>
<li>M4 have 294 taxa where all have molecular data, but only 93 have morphological data.</li>
</ul>
<p>When I was checking my results of M3 (after 100 million generation) I got some very weird numbers on the ESS column on Tracer (See photo). At first I thought it was some parameterization problem… however I got the same issues on two of the four runs of M2 (the others seem ok.) M1 and M4 seem to be within the expected.</p>
<p>Did any of you guys had a similar issue before? What you think it my be the problem?</p>
<p>I appreciate any feedback you can give. Thanks!</p>
<p><div class="lightbox-wrapper"><a class="lightbox" data-download-href="https://www.phylobabble.org/uploads/default/60245b4126951b43a4f0760d194ff4f855526c6d" href="https://www.phylobabble.org/uploads/default/original/1X/60245b4126951b43a4f0760d194ff4f855526c6d.png" title="17 PM"><img alt="17 PM" data-base62-sha1="dIvJi8Hh7ZqGda9RYXYKQxrunPn" data-small-upload="https://www.phylobabble.org/uploads/default/optimized/1X/60245b4126951b43a4f0760d194ff4f855526c6d_2_10x10.png" height="500" src="https://www.phylobabble.org/uploads/default/optimized/1X/60245b4126951b43a4f0760d194ff4f855526c6d_2_547x500.png" srcset="https://www.phylobabble.org/uploads/default/optimized/1X/60245b4126951b43a4f0760d194ff4f855526c6d_2_547x500.png, https://www.phylobabble.org/uploads/default/optimized/1X/60245b4126951b43a4f0760d194ff4f855526c6d_2_820x750.png 1.5x" width="547"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">17 PM</span><span class="informations">1325×1210 169 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">afmagee</div>
          <div class="post_content">
<p>It looks like there are 4 spikes, give or take. Since this is the combined analysis, that makes me suspicious that each analysis is in a very different region of parameter space (and thus when combining them the ESS is very bad).</p>
<p>What is each run doing? Are the ESS there also terrible? What is the ASDSF between the runs?</p>
<p>This isn’t a direct attack on the problem at hand, but identifying the mode of MCMC failure can help find the cause.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/386_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tsmoreira</div>
          <div class="post_content">
<p>Hi <span class="mention">@afmagee</span></p>
<p>So the individual runs are also like it, if not worse. In the matrix M2 This also happens but not in all the runs.</p>
<p>The ASDSF is 0.223456</p>
<p><div class="lightbox-wrapper"><a class="lightbox" data-download-href="https://www.phylobabble.org/uploads/default/5df2d372df57deaaeeeb6299ab21d5e36bae8aaa" href="https://www.phylobabble.org/uploads/default/original/1X/5df2d372df57deaaeeeb6299ab21d5e36bae8aaa.png" title="31 AM"><img alt="31 AM" data-base62-sha1="dp6EJuEsaoiT9yWdxWlDJhXB0Ho" data-small-upload="https://www.phylobabble.org/uploads/default/optimized/1X/5df2d372df57deaaeeeb6299ab21d5e36bae8aaa_2_10x10.png" height="500" src="https://www.phylobabble.org/uploads/default/optimized/1X/5df2d372df57deaaeeeb6299ab21d5e36bae8aaa_2_472x500.png" srcset="https://www.phylobabble.org/uploads/default/optimized/1X/5df2d372df57deaaeeeb6299ab21d5e36bae8aaa_2_472x500.png, https://www.phylobabble.org/uploads/default/optimized/1X/5df2d372df57deaaeeeb6299ab21d5e36bae8aaa_2_708x750.png 1.5x, https://www.phylobabble.org/uploads/default/optimized/1X/5df2d372df57deaaeeeb6299ab21d5e36bae8aaa_2_944x1000.png 2x" width="472"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">31 AM</span><span class="informations">1241×1313 166 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div><div class="lightbox-wrapper"><a class="lightbox" data-download-href="https://www.phylobabble.org/uploads/default/d99b1b5e263f745f9ef0bc402c961395b0d0f4f3" href="https://www.phylobabble.org/uploads/default/original/1X/d99b1b5e263f745f9ef0bc402c961395b0d0f4f3.png" title="44 AM"><img alt="44 AM" data-base62-sha1="v31VpVs6FLkhMuHlCpnhrETDUYj" data-small-upload="https://www.phylobabble.org/uploads/default/optimized/1X/d99b1b5e263f745f9ef0bc402c961395b0d0f4f3_2_10x10.png" height="499" src="https://www.phylobabble.org/uploads/default/optimized/1X/d99b1b5e263f745f9ef0bc402c961395b0d0f4f3_2_473x499.png" srcset="https://www.phylobabble.org/uploads/default/optimized/1X/d99b1b5e263f745f9ef0bc402c961395b0d0f4f3_2_473x499.png, https://www.phylobabble.org/uploads/default/optimized/1X/d99b1b5e263f745f9ef0bc402c961395b0d0f4f3_2_709x748.png 1.5x, https://www.phylobabble.org/uploads/default/optimized/1X/d99b1b5e263f745f9ef0bc402c961395b0d0f4f3_2_946x998.png 2x" width="473"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">44 AM</span><span class="informations">1246×1315 174 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div><div class="lightbox-wrapper"><a class="lightbox" data-download-href="https://www.phylobabble.org/uploads/default/e6117dd77ce9e375ee5346b23992aca5a05d1bd9" href="https://www.phylobabble.org/uploads/default/original/1X/e6117dd77ce9e375ee5346b23992aca5a05d1bd9.png" title="00 AM"><img alt="00 AM" data-base62-sha1="wPhid3a7GIdJKEaNKVMVDPkZHZL" data-small-upload="https://www.phylobabble.org/uploads/default/optimized/1X/e6117dd77ce9e375ee5346b23992aca5a05d1bd9_2_10x10.png" height="499" src="https://www.phylobabble.org/uploads/default/optimized/1X/e6117dd77ce9e375ee5346b23992aca5a05d1bd9_2_473x499.png" srcset="https://www.phylobabble.org/uploads/default/optimized/1X/e6117dd77ce9e375ee5346b23992aca5a05d1bd9_2_473x499.png, https://www.phylobabble.org/uploads/default/optimized/1X/e6117dd77ce9e375ee5346b23992aca5a05d1bd9_2_709x748.png 1.5x, https://www.phylobabble.org/uploads/default/optimized/1X/e6117dd77ce9e375ee5346b23992aca5a05d1bd9_2_946x998.png 2x" width="473"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">00 AM</span><span class="informations">1244×1315 165 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div><div class="lightbox-wrapper"><a class="lightbox" data-download-href="https://www.phylobabble.org/uploads/default/b0d35c0efc81efcd66a50e7be273223798849caf" href="https://www.phylobabble.org/uploads/default/original/1X/b0d35c0efc81efcd66a50e7be273223798849caf.png" title="16 AM"><img alt="16 AM" data-base62-sha1="pegRYP05FcCgbOXhaWPJEwryIIT" data-small-upload="https://www.phylobabble.org/uploads/default/optimized/1X/b0d35c0efc81efcd66a50e7be273223798849caf_2_10x10.png" height="500" src="https://www.phylobabble.org/uploads/default/optimized/1X/b0d35c0efc81efcd66a50e7be273223798849caf_2_473x500.png" srcset="https://www.phylobabble.org/uploads/default/optimized/1X/b0d35c0efc81efcd66a50e7be273223798849caf_2_473x500.png, https://www.phylobabble.org/uploads/default/optimized/1X/b0d35c0efc81efcd66a50e7be273223798849caf_2_709x750.png 1.5x, https://www.phylobabble.org/uploads/default/optimized/1X/b0d35c0efc81efcd66a50e7be273223798849caf_2_946x1000.png 2x" width="473"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use xlink:href="#far-image"></use></svg><span class="filename">16 AM</span><span class="informations">1244×1314 165 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use xlink:href="#discourse-expand"></use></svg>
</div></a></div></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">afmagee</div>
          <div class="post_content">
<p>Wow… that really is bad (but helpful). The ASDSF is pretty clearly showing that runs are not near each other in treespace (the different TL and TH values also support this), which is bad but also not immediately an explanation for why the individual runs are doing so poorly. Extrapolating from those histograms, I would guess that the trees in each case are largely stuck in place.</p>
<p>It is interesting that this happens with the subsets with the most overlap. I wonder if the morphological and molecular datasets are at odds over the tree? Have you examined them separately? I wouldn’t think that 256 morphological characters would have the power to fight 4521 nucleotides over the tree topology, but perhaps they do (examining them separately would also let you see if they contribute enough to the likelihood to do that). How are you setting the “coding” option for the morphological characters? Are you allowing among-site rate variation for them?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/386_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tsmoreira</div>
          <div class="post_content">
<p>It occurred me that. I tried to ran simplified analysis for shorter amount of  generations (like 10KK) just to se how the chains behave. I also did tests isolating things like partition scheme, dating parameters…</p>
<p>The only test where the same phenomena occurred was I maintained the partition scheme (and excluded all other parameters sucha s clock rate, etc.)</p>
<p>Thats my MrBayes Block</p>
<p>outgroup Steatoda_grossa_THERIDIIDAE;
constraint ingroup = 2-.;</p>
<p>set autoclose=no nowarn=yes;</p>
<p>charset Subset1 = 1-653;         [16S]
charset Subset2 = 654-2594;      [18S]
charset Subset3 = 2595-3883\3;   [COI-1st]
charset Subset4 = 2596-3883\3;   [COI-2nd]
charset Subset5 = 2597-3883\3;   [COI-3rd]
charset Subset6 = 3884-4265\3;   [H3-1st]
charset Subset7 = 3885-4265\3;   [H3-2nd]
charset Subset8 = 3886-4265\3;   [H3-3rd]
charset morpho = 4266-4521;     [Morphology]</p>
<p>partition PartitionFinder = 9:Subset1, Subset2, Subset3, Subset4, Subset5, Subset6, Subset7, Subset8, morpho;
set partition=PartitionFinder;</p>
<p>[GTR+I+G]
lset applyto=(1) nst=6 rates=invgamma;</p>
<p>[SYM+I+G]
lset applyto=(2) nst=6 rates=invgamma;
prset applyto=(2) statefreqpr=fixed(equal);</p>
<p>[GTR+I+G]
lset applyto=(3) nst=6 rates=invgamma;</p>
<p>[GTR+G]
lset applyto=(4) nst=6 rates=gamma;</p>
<p>[GTR+I+G]
lset applyto=(5) nst=6 rates=invgamma;</p>
<p>[SYM+I+G]
lset applyto=(6) nst=6 rates=invgamma;
prset applyto=(6) statefreqpr=fixed(equal);</p>
<p>[GTR+I+G]
lset applyto=(7) nst=6 rates=invgamma;</p>
<p>[JC+I+G]
lset applyto=(8) nst=1 rates=invgamma;
prset applyto=(8) statefreqpr=fixed(equal);</p>
<p>[morpho]
lset applyto=(9) coding=variable;</p>
<p>prset applyto=(all) ratepr=variable;
unlink statefreq=(all) revmat=(all) shape=(all) pinvar=(all) tratio=(all);</p>
<p>prset nodeagepr = calibrated;
prset brlenspr = clock:fossilization;
prset speciationpr = exp(10);
prset extinctionpr = beta(1,1);
prset fossilizationpr =  fixed(0);
prset sampleprob = 0.01;
prset samplestrat = diversity;
prset topologypr = constraint(ingroup);
prset treeagepr = unif(175,225);<br/>
prset clockratepr = lognorm(-1.90308998699,1);<br/>
prset clockvarpr = igr;
prset igrvarpr = exp(10);</p>
<p>mcmcp ngen= 10000000 relburnin=yes burninfrac=0.33 printfreq=10000 samplefreq=10000 nchains=4 nruns=4 savebrlens=yes checkpoint=yes append=no;</p>
<p>mcmc;
end;</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>