<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Oneboxes for PubMed</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>

  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="40" alt="phylobabble" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">Archive 04/01/2022.</div>
    <h1 class="topic-title">Oneboxes for PubMed</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/114_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">ematsen</div>
          <div class="post_content">
<p>It would be so neat if we could have those little previews for PubMed papers.</p>
<p>They are called “oneboxes” and the code for making them is <a href="http://github.com/dysania/onebox">here</a>.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/114_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">ematsen</div>
          <div class="post_content">
<p>OK, I’ve made some good progress on this.</p>
<p>First of all, a onebox is something like this:</p>
<aside class="onebox githubcommit" data-onebox-src="https://github.com/OpenTreeOfLife/gcmdr/commit/3c84e73679434c8295179165ae7fc02be8b5ae7b">
<header class="source">
<a href="https://github.com/OpenTreeOfLife/gcmdr/commit/3c84e73679434c8295179165ae7fc02be8b5ae7b" rel="noopener" target="_blank">github.com/OpenTreeOfLife/gcmdr</a>
</header>
<article class="onebox-body">
<div class="github-row">
<div class="github-icon-container" title="Commit">
<svg aria-hidden="true" class="github-icon" height="60" viewbox="0 0 14 16" width="60"><path d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
</div>
<div class="github-info-container">
<h4>
<a href="https://github.com/OpenTreeOfLife/gcmdr/commit/3c84e73679434c8295179165ae7fc02be8b5ae7b" rel="noopener" target="_blank">add decapod studies</a>
</h4>
<div class="github-info">
<div class="date">
        committed <span class="discourse-local-date" data-date="2014-02-15" data-format="ll" data-time="13:32:54" data-timezone="UTC">01:32PM - 15 Feb 14 UTC</span>
</div>
<div class="user">
<a href="https://github.com/josephwb" rel="noopener" target="_blank">
<img alt="josephwb" class="onebox-avatar-inline" height="20" src="https://www.phylobabble.org/uploads/default/original/1X/26dbf5c867a4fb23a7afcb0251e3f5cf1f187ecf.jpeg" width="20"/>
          josephwb
        </a>
</div>
<div class="lines" title="changed 46 files with 5961 additions and 160 deletions">
<a href="https://github.com/OpenTreeOfLife/gcmdr/commit/3c84e73679434c8295179165ae7fc02be8b5ae7b" rel="noopener" target="_blank">
<span class="added">+5961</span>
<span class="removed">-160</span>
</a>
</div>
</div>
</div>
</div>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>It’s a lovely little formatted box that you automatically get when you paste in a github commit (analogous for some other sites).</p>
<p>I have forked the onebox repository <a href="https://github.com/matsen/onebox/tree/pubmed">here</a> and made a pubmed onebox. That should be the hard part. Now, what do we want to have it show? Here’s what it generates so far:</p>
<pre><code class="lang-auto">&lt;aside class="onebox pubmed"&gt;
  &lt;header class="source"&gt;
    &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/7288891"&gt;
      www.ncbi.nlm.nih.gov
    &lt;/a&gt;
  &lt;/header&gt;
  &lt;article class="onebox-body"&gt;
    &lt;h4&gt;
  &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/7288891" target="_blank"&gt;Evolutionary trees from DNA sequences: a maximum likelihood approach.&lt;/a&gt;
&lt;/h4&gt;

Felsenstein
in
&lt;i&gt;Journal of molecular evolution&lt;/i&gt;, 1981

The application of maximum likelihood techniques to the estimation of evolutionary trees from nucleic acid sequence data is discussed. A computationally feasible method for finding such maximum likelihood estimates is developed, and a computer program is available. This method has advantages over the traditional parsimony algorithms, which can give misleading results if rates of evolution differ in different lineages. It also allows the testing of hypotheses about the constancy of evolutionary rates by likelihood ratio tests, and gives rough indication of the error of ;the estimate of the tree.



  &lt;/article&gt;
  &lt;div style='clear: both'&gt;&lt;/div&gt;
&lt;/aside&gt;
</code></pre>
<p>You people who know HTML-- help! Also, rubyists (<em>ahem</em> <span class="mention">@metasoarous</span>, <span class="mention">@trvrb</span>), I’d love some feedback on my code.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/379_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">metasoarous</div>
          <div class="post_content">
<p>It looks like typically the <code>header</code> tag would go inside <code>article</code> (see <a href="http://www.w3schools.com/tags/tag_header.asp" rel="nofollow noopener">w3schools</a>) but it probably renders fine either way. Might want to put the abstract in a <code>p</code> tag and “Felsenstein …” in a container (<code>p</code>? <code>h5</code>?) as well.</p>
<p>Yer ruby is looking fine as far as I can tell. Mostly in the corresponding <a href="https://github.com/matsen/onebox/blob/5baa26abe418568a840f5aa64a3196501e1d2b84/lib/onebox/engine/pubmed_onebox.rb" rel="nofollow noopener">engine</a> and spec as far as I can tell yeah? Also, good job rocking the mustache…</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/114_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">ematsen</div>
          <div class="post_content">
<aside class="quote" data-post="3" data-topic="12">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//www.phylobabble.org/user_avatar/www.phylobabble.org/metasoarous/40/122_1.png" width="20"/> metasoarous:</div>
<blockquote>
<p>It looks like typically the header tag would go inside article (see w3schools) but it probably renders fine either way.</p>
</blockquote>
</aside>
<p>I don’t actually generate this bit!</p>
<aside class="quote" data-post="3" data-topic="12">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//www.phylobabble.org/user_avatar/www.phylobabble.org/metasoarous/40/122_1.png" width="20"/> metasoarous:</div>
<blockquote>
<p>Might want to put the abstract in a p tag and “Felsenstein …” in a container (p? h5?) as well.</p>
</blockquote>
</aside>
<p>I’m with you on the <code>&lt;p&gt;</code> for the abstract. However, what makes me sad about the current state of the HTML output is that it doesn’t put the title and author in closely spaced lines like in the GH commit example I put in above, and adding a <code>&lt;p&gt;</code> will only space it out more. What’s a better alternative? A <code>&lt;ul&gt;</code> without bullets?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/379_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">metasoarous</div>
          <div class="post_content">
<p>It looks like they’re using <code>div</code>s for separation in the github example, so if you follow suit the stylesheets might pick up on that for you without any work. If not, you could try adding some custom <code>div</code> (or other container) classes, and tweak the stylesheets a bit to take advanatage of that. You might also try putting both in the same <code>p</code> tag, with a <code>br/</code> separating them.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/114_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">ematsen</div>
          <div class="post_content">
<aside class="onebox githubpullrequest" data-onebox-src="https://github.com/discourse/onebox/pull/199">
<header class="source">
<a href="https://github.com/discourse/onebox/pull/199" rel="noopener" target="_blank">github.com/discourse/onebox</a>
</header>
<article class="onebox-body">
<div class="github-row">
<div class="github-icon-container" title="Pull Request">
<svg aria-hidden="true" class="github-icon" height="60" viewbox="0 0 12 16" width="60"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
</div>
<div class="github-info-container">
<h4>
<a href="https://github.com/discourse/onebox/pull/199" rel="noopener" target="_blank">Adding PubMed support.</a>
</h4>
<div class="branches">
<code>discourse:master</code> ← <code>matsen:pubmed-pr</code>
</div>
<div class="github-info">
<div class="date">
        opened <span class="discourse-local-date" data-date="2014-02-20" data-format="ll" data-time="02:58:46" data-timezone="UTC">02:58AM - 20 Feb 14 UTC</span>
</div>
<div class="user">
<a href="https://github.com/matsen" rel="noopener" target="_blank">
<img alt="matsen" class="onebox-avatar-inline" height="20" src="https://www.phylobabble.org/uploads/default/original/1X/98a5681cc913bf34491becf6fa6df8c08f52c876.jpeg" width="20"/>
          matsen
        </a>
</div>
<div class="lines" title="1 commits changed 6 files with 524 additions and 0 deletions">
<a href="https://github.com/discourse/onebox/pull/199/files" rel="noopener" target="_blank">
<span class="added">+524</span>
<span class="removed">-0</span>
</a>
</div>
</div>
</div>
</div>
<div class="github-row">
<p class="github-body-container">[PubMed](http://www.ncbi.nlm.nih.gov/pubmed/) is the canonical index of the biol<span class="show-more-container"><a class="show-more" href="https://github.com/discourse/onebox/pull/199" rel="noopener" target="_blank">…</a></span><span class="excerpt hidden">ogical and medical literature in the USA. Here I have added onebox support for it which mimics the GitHub commit template. 

Thanks for considering this PR, and please let me know how I can improve it.</span></p>
</div>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>

          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/114_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">ematsen</div>
          <div class="post_content">
<p>Pull request <a href="https://github.com/dysania/onebox/pull/199">merged</a>, thanks to some key help from <span class="mention">@metasoarous</span>.</p>
<p>Will be available once the upgrade cycle goes through, or when I work through <a href="http://community.bitnami.com/t/bundle-install-not-working-on-discourse-vm/22774">issues concerning bundler</a> to do a more direct modification.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/114_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">ematsen</div>
          <div class="post_content">
<p>This now works with the upgrade. Pasting in</p>
<p><code>http://www.ncbi.nlm.nih.gov/pubmed/7288891</code></p>
<p>gives</p>
<aside class="onebox pubmed">
<header class="source">
<a href="https://www.ncbi.nlm.nih.gov/pubmed/7288891" rel="nofollow noopener" target="_blank">ncbi.nlm.nih.gov</a>
</header>
<article class="onebox-body">
<h4>
<a href="https://www.ncbi.nlm.nih.gov/pubmed/7288891" rel="nofollow noopener" target="_blank">Evolutionary trees from DNA sequences: a maximum likelihood approach.</a>
</h4>
<div class="date">
  J Felsenstein,
  <i>Journal of molecular evolution</i>, 1981
</div>
<p class="pubmed-abstract">
  The application of maximum likelihood techniques to the estimation of evolutionary trees from nucleic acid sequence data is discussed. A computationally feasible method for finding such maximum likelihood estimates is developed, and a computer program is available. This method has advantages over the traditional parsimony algorithms, which can give misleading results if rates of evolution differ in different lineages. It also allows the testing of hypotheses about the constancy of evolutionary rates by likelihood ratio tests, and gives rough indication of the error of ;the estimate of the tree.
</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>

          </div>
        </div>
      </div>


    </div>
  </body>
</html>